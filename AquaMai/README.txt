This part of code copied from https://github.com/MewoLab/AquaMai.